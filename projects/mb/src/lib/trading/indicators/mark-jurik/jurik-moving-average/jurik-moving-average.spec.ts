import { } from 'jasmine';

import { JurikMovingAverage } from './jurik-moving-average';

// ng test mb  --code-coverage --include='**/indicators/mark-juric/jurik-moving-average/*.spec.ts'
// ng test mb  --code-coverage --include='**/indicators/**/*.spec.ts'
// ng test mb  --code-coverage --include='**/indicators/*.spec.ts'

/**
 * Input data is taken from the TA-Lib (http://ta-lib.org/) tests,
 *   test_data.c, TA_SREF_close_daily_ref_0_PRIV[252].
 */
const input = [
  91.500000, 94.815000, 94.375000, 95.095000, 93.780000, 94.625000, 92.530000, 92.750000, 90.315000, 92.470000,
  96.125000, 97.250000, 98.500000, 89.875000, 91.000000, 92.815000, 89.155000, 89.345000, 91.625000, 89.875000,
  88.375000, 87.625000, 84.780000, 83.000000, 83.500000, 81.375000, 84.440000, 89.250000, 86.375000, 86.250000,
  85.250000, 87.125000, 85.815000, 88.970000, 88.470000, 86.875000, 86.815000, 84.875000, 84.190000, 83.875000,
  83.375000, 85.500000, 89.190000, 89.440000, 91.095000, 90.750000, 91.440000, 89.000000, 91.000000, 90.500000,
  89.030000, 88.815000, 84.280000, 83.500000, 82.690000, 84.750000, 85.655000, 86.190000, 88.940000, 89.280000,
  88.625000, 88.500000, 91.970000, 91.500000, 93.250000, 93.500000, 93.155000, 91.720000, 90.000000, 89.690000,
  88.875000, 85.190000, 83.375000, 84.875000, 85.940000, 97.250000, 99.875000, 104.940000, 106.000000, 102.500000,
  102.405000, 104.595000, 106.125000, 106.000000, 106.065000, 104.625000, 108.625000, 109.315000, 110.500000,
  112.750000, 123.000000, 119.625000, 118.750000, 119.250000, 117.940000, 116.440000, 115.190000, 111.875000,
  110.595000, 118.125000, 116.000000, 116.000000, 112.000000, 113.750000, 112.940000, 116.000000, 120.500000,
  116.620000, 117.000000, 115.250000, 114.310000, 115.500000, 115.870000, 120.690000, 120.190000, 120.750000,
  124.750000, 123.370000, 122.940000, 122.560000, 123.120000, 122.560000, 124.620000, 129.250000, 131.000000,
  132.250000, 131.000000, 132.810000, 134.000000, 137.380000, 137.810000, 137.880000, 137.250000, 136.310000,
  136.250000, 134.630000, 128.250000, 129.000000, 123.870000, 124.810000, 123.000000, 126.250000, 128.380000,
  125.370000, 125.690000, 122.250000, 119.370000, 118.500000, 123.190000, 123.500000, 122.190000, 119.310000,
  123.310000, 121.120000, 123.370000, 127.370000, 128.500000, 123.870000, 122.940000, 121.750000, 124.440000,
  122.000000, 122.370000, 122.940000, 124.000000, 123.190000, 124.560000, 127.250000, 125.870000, 128.860000,
  132.000000, 130.750000, 134.750000, 135.000000, 132.380000, 133.310000, 131.940000, 130.000000, 125.370000,
  130.130000, 127.120000, 125.190000, 122.000000, 125.000000, 123.000000, 123.500000, 120.060000, 121.000000,
  117.750000, 119.870000, 122.000000, 119.190000, 116.370000, 113.500000, 114.250000, 110.000000, 105.060000,
  107.000000, 107.870000, 107.000000, 107.120000, 107.000000, 91.000000, 93.940000, 93.870000, 95.500000, 93.000000,
  94.940000, 98.250000, 96.750000, 94.810000, 94.370000, 91.560000, 90.250000, 93.940000, 93.620000, 97.000000,
  95.000000, 95.870000, 94.060000, 94.620000, 93.750000, 98.000000, 103.940000, 107.870000, 106.060000, 104.500000,
  105.000000, 104.190000, 103.060000, 103.420000, 105.270000, 111.870000, 116.000000, 116.620000, 118.280000,
  113.370000, 109.000000, 109.700000, 109.250000, 107.000000, 109.190000, 110.000000, 109.200000, 110.120000,
  108.000000, 108.620000, 109.750000, 109.810000, 109.000000, 108.750000, 107.870000,
];

// Output data is generated using original Jurik DLL.

const expectedLength20PhaseMin100 = [
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  85.250000000000000, 84.979442918875577, 84.830442062746670, 84.812390425527042, 84.885781458628543, 85.014889368620658,
  85.173919521462039, 85.326636716585114, 85.447740355801258, 85.524061486470231, 85.548607673535727, 85.543868168471761,
  85.578676871633178, 85.677213680545762, 85.977740695821311, 86.334227020671392, 86.757754522501926, 87.146750522175765,
  87.511662489466261, 87.852159071929634, 88.153512714445455, 88.407857865238043, 88.482097619351620, 88.312390230094266,
  87.900585972087654, 87.516831347666340, 87.172483411396513, 86.877150998083280, 86.677270384726725, 86.588860734380631,
  86.568436284321891, 86.602544609830531, 86.924889416015134, 87.309841140834493, 87.921886930661785, 88.601913300396689,
  89.216658679021251, 89.737782523694833, 90.156583162560210, 90.473229889566966, 90.688434819816706, 90.522795882652730,
  89.759007893702176, 89.073083881095869, 88.499011303307228, 89.405825505423749, 91.654030600320041, 94.963268960950430,
  98.366456878776916, 100.492788891021306, 101.710651174520166, 102.553244444364211, 103.360476496932478, 104.002217351469170,
  104.493569874555462, 104.856417516444495, 105.313191763452764, 105.865350039818665, 106.544627237068838, 107.633824628907632,
  110.890492752573323, 114.041887846441767, 116.053645506863035, 117.333336489866952, 118.169172305458346, 118.728505113178485,
  119.044439659366162, 118.731371484034185, 117.916205553283660, 117.251775576695749, 116.739811887723732, 116.354266016863335,
  116.029726961964215, 115.751699420476271, 115.501103445604429, 115.297027808522472, 115.324100061297557, 115.389703580844142,
  115.482209014213964, 115.575204954365304, 115.645624097866488, 115.695262328654081, 115.730452840314129, 115.835960501361740,
  115.985586687610265, 116.185792111965100, 117.015015007858011, 117.801828109976739, 118.487664221880067, 119.085260055013265,
  119.610733723420566, 120.069825500732108, 120.493518820744185, 121.677948432377107, 123.478337455501290, 125.468693093436769,
  126.950813616717824, 128.202049765407480, 129.343840997764232, 131.088981786860899, 132.699702964001432, 133.975517457984949,
  134.918442890078751, 135.623686263726597, 136.139013838428212, 136.488954180158117, 136.231661537685341, 135.795364476122813,
  133.850315576307793, 132.115739065879012, 130.378246099206507, 129.042012983652683, 128.048060631678197, 127.309318481260931,
  126.763945231139246, 126.303625970309184, 125.558839788376318, 124.619826497620210, 123.877462952733282, 123.312043396956852,
  122.886790680062262, 122.540011843739009, 122.279374424267161, 122.079284633556611, 121.943690720983611, 121.967994857290080,
  122.218999847077157, 122.483576279599419, 122.729154136744725, 122.927957173950276, 123.095305420034791, 123.217462661434894,
  123.295074106211914, 123.338215982422156, 123.365547560291404, 123.380152560792027, 123.397989914662389, 123.452247327218160,
  123.541656870448335, 123.689413566000866, 124.181361422437334, 124.690841566400707, 125.836109897096179, 127.127073721502782,
  128.189809062005310, 129.069391711926698, 129.787285533905617, 130.346853506104139, 130.556830542221860, 130.669184652879721,
  130.687230444877429, 130.542262157324814, 129.836375409838041, 129.205752882048643, 128.580949152103955, 128.010721870394690,
  127.207377948973146, 126.462550279171921, 125.401890172990335, 124.507434548650892, 123.772247817474110, 123.154570357189272,
  122.476002962955164, 121.351649692403370, 120.304389899293511, 118.550289154313262, 115.090137433298622, 112.599116739333880,
  110.880906652497202, 109.679984307477582, 108.821148623561584, 108.195322806483077, 104.997587553453826, 101.433189881747552,
  98.748345129173032, 97.060967137264612, 95.893894931974287, 95.106098036745976, 94.583851484477918, 94.271149567068505,
  94.101196805754213, 94.022301779046060, 93.964125222075666, 93.807227414384954, 93.668389212889906, 93.553042151511420,
  93.494794902688227, 93.485465530770753, 93.523956317728334, 93.586705439451492, 93.664051905152988, 93.740517147150271,
  93.848481985353445, 94.675616079395738, 97.223395941083481, 99.239653963459574, 100.750717948827798, 101.886483543235599,
  102.742541010280263, 103.367756705302000, 103.809732560154401, 104.126113121762174, 104.909551947800125, 107.241958195791014,
  109.561225304454268, 111.769293753770611, 113.375501784445845, 114.241035348287213, 114.712005563730401, 114.892088071369827,
  114.643600257381223, 114.304500919812014, 113.918516200927286, 113.508547879522808, 113.101259335855033, 112.693085048154501,
  112.292049264715118, 111.915886136197855, 111.574712375368520, 111.265060632869805, 110.982153949162324, 110.714824549439470,
];

const expectedLength20PhaseMin30 = [
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  85.250000000000000, 84.986689707188575, 84.848870931634693, 84.857924699891740, 84.970412353447585, 85.141306012508721,
  85.338982657142935, 85.516596210147171, 85.643062744496092, 85.704346449562209, 85.694633208043001, 85.648917507768402,
  85.659628802090779, 85.760069923898286, 86.117365640231654, 86.546284394749037, 87.056294738864992, 87.518436229782253,
  87.946529687952577, 88.339371876687167, 88.676112629229607, 88.946710233645447, 88.963312336764588, 88.668479569430744,
  88.083512747339057, 87.552345836147566, 87.089356456388245, 86.705657844148888, 86.467107349529968, 86.384455927671794,
  86.391156706608285, 86.466983535863378, 86.905413909913989, 87.412015510151846, 88.178346795744517, 89.007892635634633,
  89.745809088984458, 90.359072245671939, 90.833313340729774, 91.168944141285067, 91.368304384919441, 91.052059000147949,
  90.010048483654899, 89.096102244834071, 88.343944450875412, 89.274696204418447, 91.717747844290926, 95.328071266818583,
  99.007671146166643, 101.250988779937316, 102.492201687041245, 103.309904202338046, 104.094927441663643, 104.717364027780846,
  105.189303362217856, 105.528847017518842, 105.965441387747177, 106.517410896219644, 107.219710212580125, 108.372778014360833,
  111.878482462734212, 115.207901500329314, 117.280724470050984, 118.551694629050758, 119.352634421523291, 119.859260405021175,
  120.095914759783483, 119.561679600404659, 118.443383085934087, 117.557566061132164, 116.884334352617174, 116.386640594308489,
  115.973824752020619, 115.625056966895926, 115.314481366460001, 115.069958191112320, 115.133567508057254, 115.241820812806296,
  115.379461152496361, 115.510416136605471, 115.604198228026121, 115.665917407910584, 115.706383533487724, 115.838825268933178,
  116.030350212620803, 116.288389524885346, 117.303036409872462, 118.256262510936764, 119.079172550951583, 119.784900006041170,
  120.393251212755970, 120.910611912834227, 121.377376711944336, 122.651054125735953, 124.576753920118691, 126.686519914003185,
  128.238281141729658, 129.521918983812583, 130.675911690344861, 132.445940698829844, 134.073043302085608, 135.347126347703181,
  136.271598786918872, 136.946750514283792, 137.417871048380022, 137.703870090054920, 137.218528058589840, 136.539051444543531,
  134.090150233688092, 131.955416044925840, 129.885461594003175, 128.309988640352657, 127.164227759034802, 126.337241250252902,
  125.750959206297892, 125.286806970384887, 124.530357085404987, 123.557237835284795, 122.800802128058436, 122.247523485969140,
  121.854993156725499, 121.548878243235038, 121.340372810995930, 121.197270547574249, 121.128369174312084, 121.267847240551220,
  121.693753120181299, 122.115002240085502, 122.489127871049689, 122.781430836689580, 123.018427904829892, 123.184188905958123,
  123.283163747573411, 123.332458561660985, 123.360235315459846, 123.371484574541014, 123.388999614148204, 123.458831659019566,
  123.576932553715139, 123.773973676234760, 124.402593633944264, 125.047848396645094, 126.430753465813680, 127.956130540062844,
  129.197297796488556, 130.206804625390532, 131.007541337864410, 131.600244010050517, 131.698737204835282, 131.695774942990880,
  131.589715928197023, 131.284464068012795, 130.283012265753882, 129.405861443083239, 128.565348106163640, 127.814713441717132,
  126.816671308475819, 125.907955144707657, 124.664190002764173, 123.626725713613709, 122.793511551425127, 122.110238516858431,
  121.382511087297246, 120.182359090715437, 119.069178440819428, 117.206377036882344, 113.556441208148144, 110.963435202606874,
  109.207476451834950, 108.016668649570107, 107.193200523547091, 106.617103904679141, 103.362441869731001, 99.747718180428649,
  97.070348017147865, 95.432733328176113, 94.349236006329491, 93.647202862244939, 93.221698483186472, 93.017700368392809,
  92.958443211146474, 92.984793821065551, 93.019411675157912, 92.920655019061954, 92.831794110213636, 92.764654731738901,
  92.768850690723355, 92.832503348753690, 92.953681159156702, 93.098669278326554, 93.254373079364470, 93.399808135458386,
  93.581782906965401, 94.637455653504475, 97.627153871984191, 99.961398772029767, 101.692512708755785, 102.972178464591067,
  103.915207538338493, 104.576025123470956, 105.012105677028956, 105.297934595134620, 106.036170451289649, 108.414318903864412,
  110.799237600315990, 113.072520671015781, 114.707327540632733, 115.493678574199066, 115.846533714201996, 115.880139379489293,
  115.410338937878407, 114.862607565817143, 114.288814126017925, 113.712757298629214, 113.165078192065550, 112.634692799165734,
  112.128711090967258, 111.668655745472066, 111.265316244402570, 110.910652821738793, 110.595629408057974, 110.302962138347496,
];

const expectedLength20Phase0 = [
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  85.250000000000000, 84.989795473608439, 84.856769018300994, 84.877439388905188, 85.006682736941471, 85.195484574175055,
  85.409724001006197, 85.598007421673785, 85.726772339651035, 85.781611433744501, 85.757215579974698, 85.693938653181263,
  85.694322486572631, 85.795579742477955, 86.177204902121815, 86.637166126496609, 87.184240545877742, 87.677730104470754,
  88.132901344446708, 88.548177364440392, 88.900084021279937, 89.177646962962896, 89.169547215655854, 88.821089286289222,
  88.161909936732499, 87.567566331210941, 87.053730618527538, 86.632160778176981, 86.377037477302778, 86.296853867653709,
  86.315179744731012, 86.408885932734577, 86.897067264442057, 87.455804525573541, 88.288258166494231, 89.181883779308009,
  89.972587836111529, 90.625339269376411, 91.123340559945291, 91.467107392021376, 91.659677055677733, 91.278886050503033,
  90.117637307920347, 89.105967257864734, 88.277487228404652, 89.218497932559032, 91.745055234564163, 95.484415112190646,
  99.282477260762235, 101.575931589472759, 102.827151906693146, 103.634186955755425, 104.409692132262734, 105.023855460485862,
  105.487474856930319, 105.817031089407863, 106.244976941016219, 106.796865548962927, 107.509031487799263, 108.689472322412215,
  112.301906624231748, 115.707621637709693, 117.806615454274379, 119.073848117272391, 119.859832471265420, 120.343869815810919,
  120.546546945676639, 119.917525935992018, 118.669316314212850, 117.688619125890625, 116.946272551857220, 116.400515413213569,
  115.949866662044798, 115.570781629647215, 115.234500475398121, 114.972642640793694, 115.051910699525706, 115.178442483647217,
  115.335426354617383, 115.482649500422681, 115.586444283808817, 115.653341013306218, 115.696068116276393, 115.840053026463792,
  116.049534580482458, 116.332359844708307, 117.426474153592949, 118.451020111348214, 119.332676120553671, 120.084745699338853,
  120.728615851042591, 121.270948946592299, 121.756172951030138, 123.068099422889773, 125.047503833526164, 127.208445694245938,
  128.790052938163285, 130.087577220271896, 131.246799130022282, 133.027494518245106, 134.661617732693117, 135.934958729011015,
  136.851522742707488, 137.513778050236851, 137.965952709787899, 138.224548337153522, 137.641470853263172, 136.857774431009545,
  134.192936515422531, 131.886706178803109, 129.674268234630375, 127.996263921795574, 126.785442242187685, 125.920636722678069,
  125.316822338508771, 124.851027398988776, 124.089578784131561, 123.101842694283903, 122.339376060340641, 121.791300666974408,
  121.412794218152612, 121.124106700161903, 120.937943548165407, 120.819264510724679, 120.778945654310007, 120.967783976234571,
  121.468647380083070, 121.957041937436685, 122.386259471466104, 122.718633835006415, 122.985480398313499, 123.169928725039497,
  123.278059308156898, 123.329991095620471, 123.357958639103472, 123.367769723290593, 123.385146628213562, 123.461653515505887,
  123.592050703686624, 123.810213723477872, 124.497407438875811, 125.200851323892692, 126.685600709549746, 128.311440605160016,
  129.629078682695678, 130.694267302589338, 131.530508110989643, 132.137411368884699, 132.188125774526782, 132.135742210181405,
  131.976495421048327, 131.602550601164808, 130.474428061146369, 129.491622254955189, 128.558661943617778, 127.730709829426743,
  126.649225605405533, 125.670271515651535, 124.348032786952956, 123.249279070026347, 122.374053151689864, 121.662667728145223,
  120.913871712015293, 119.681234547134892, 118.539802101473384, 116.630414700840518, 112.899142825940785, 110.262428829723859,
  108.490292080122529, 107.303819081895455, 106.495508480683711, 105.940724375334568, 102.661665148135484, 99.025373165577690,
  96.351206397708523, 94.734918838566784, 93.687239323910319, 93.021962073173086, 92.637918625490158, 92.480507854674684,
  92.468691670600322, 92.540147553359645, 92.614534440764615, 92.540695421066403, 92.473253351923830, 92.426774408979270,
  92.457731742738432, 92.552662413603528, 92.709277519768861, 92.889510923558717, 93.078796439740813, 93.253789987590423,
  93.467483301941940, 94.621101185265346, 97.800192985227341, 100.270717975702695, 102.096139034439204, 103.437476288029131,
  104.417778907506303, 105.093854445543357, 105.527408441403750, 105.800143798008520, 106.519006952785148, 108.916759207324418,
  111.329814298542416, 113.631046492692263, 115.278110007569964, 116.030525671018424, 116.332760064404098, 116.303589940111905,
  115.738941229520037, 115.101796128390745, 114.447513236771044, 113.800275621103381, 113.192429130441482, 112.609667549599109,
  112.058709016503883, 111.562699863732433, 111.132717902560003, 110.758763759825499, 110.429976033298956, 110.126449676450932,
];

const expectedLength20Phase30 = [
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  85.250000000000000, 84.992901240028289, 84.864667104967282, 84.896954077918622, 85.042953120435342, 85.249663135841359,
  85.480465344869444, 85.679418633200399, 85.810481934805992, 85.858876417926794, 85.819797951906409, 85.738959798594124,
  85.729016171054482, 85.831089561057638, 86.237044164011991, 86.728047858244196, 87.312186352890521, 87.837023979159284,
  88.319273000940882, 88.756982852193644, 89.124055413330311, 89.408583692280374, 89.375782094547134, 88.973699003147715,
  88.240307126125956, 87.582786826274315, 87.018104780666846, 86.558663712205103, 86.286967605075603, 86.209251807635638,
  86.239202782853752, 86.350788329605791, 86.888720618970126, 87.499593540995249, 88.398169537243959, 89.355874922981386,
  90.199366583238600, 90.891606293080869, 91.413367779160794, 91.765270642757685, 91.951049726436025, 91.505713100858102,
  90.225226132185782, 89.115832270895368, 88.211030005933850, 89.162299660699588, 91.772362624837385, 95.640758957562710,
  99.557283375357841, 101.900874399008202, 103.162102126345047, 103.958469709172803, 104.724456822861825, 105.330346893190892,
  105.785646351642797, 106.105215161296883, 106.524512494285261, 107.076320201706210, 107.798352763018400, 109.006166630463596,
  112.725330785729284, 116.207341775090072, 118.332506438497788, 119.596001605494024, 120.367030521007536, 120.828479226600635,
  120.997179131569766, 120.273372271579348, 118.895249542491584, 117.819672190649072, 117.008210751097252, 116.414390232118620,
  115.925908572068948, 115.516506292398475, 115.154519584336200, 114.875327090475025, 114.970253890994130, 115.115064154488138,
  115.291391556738404, 115.454882864239892, 115.568690339591527, 115.640764618701880, 115.685752699065091, 115.841280783994421,
  116.068718948344127, 116.376330164531282, 117.549911897313436, 118.645777711759663, 119.586179690155760, 120.384591392636523,
  121.063980489329182, 121.631285980350341, 122.134969190115910, 123.485144720043564, 125.518253746933624, 127.730371474488692,
  129.341824734596941, 130.653235456731238, 131.817686569699703, 133.609048337660369, 135.250192163300625, 136.522791110318821,
  137.431446698496103, 138.080805586189939, 138.514034371195805, 138.745226584252151, 138.064413647936533, 137.176497417475559,
  134.295722797156941, 131.817996312680322, 129.463074875257519, 127.682539203238434, 126.406656725340525, 125.504032195103207,
  124.882685470719636, 124.415247827592665, 123.648800482858150, 122.646447553283025, 121.877949992622860, 121.335077847979676,
  120.970595279579712, 120.699335157088768, 120.535514285334870, 120.441258473875081, 120.429522134307916, 120.667720711917909,
  121.243541639984841, 121.799081634787854, 122.283391071882519, 122.655836833323264, 122.952532891797119, 123.155668544120886,
  123.272954868740399, 123.327523629579971, 123.355681962747084, 123.364054872040157, 123.381293642278905, 123.464475371992194,
  123.607168853658109, 123.846453770720970, 124.592221243807359, 125.353854251140291, 126.940447953285826, 128.666750670257187,
  130.060859568902799, 131.181729979788116, 132.053474884114848, 132.674578727718881, 132.677514344218281, 132.575709477371959,
  132.363274913899630, 131.920637134316820, 130.665843856538885, 129.577383066827196, 128.551975781071945, 127.646706217136384,
  126.481779902335262, 125.432587886595428, 124.031875571141754, 122.871832426438985, 121.954594751954588, 121.215096939432001,
  120.445232336733326, 119.180110003554347, 118.010425762127340, 116.054452364798692, 112.241844443733441, 109.561422456840859,
  107.773107708410137, 106.590969514220831, 105.797816437820359, 105.264344845990024, 101.960888426539981, 98.303028150726718,
  95.632064778269154, 94.037104348957413, 93.025242641491104, 92.396721284101204, 92.054138767793830, 91.943315340956531,
  91.978940130054156, 92.095501285653711, 92.209657206371304, 92.160735823070851, 92.114712593634010, 92.088894086219625,
  92.146612794753494, 92.272821478453366, 92.464873880381020, 92.680352568790894, 92.903219800117171, 93.107771839722488,
  93.353183696918521, 94.604746717026259, 97.973232098470518, 100.580037179375637, 102.499765360122623, 103.902774111467181,
  104.920350276674100, 105.611683767615745, 106.042711205778545, 106.302353000882405, 107.001843454280646, 109.419199510784438,
  111.860390996768857, 114.189572314368746, 115.848892474507181, 116.567372767837767, 116.818986414606186, 116.727040500734518,
  116.067543521161681, 115.340984690964362, 114.606212347524163, 113.887793943577535, 113.219780068817400, 112.584642300032485,
  111.988706942040508, 111.456743981992815, 111.000119560717465, 110.606874697912218, 110.264322658539967, 109.949937214554396,
];

const expectedLength20Phase100 = [
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  85.250000000000000, 85.000148028341286, 84.883095973855291, 84.942488352283306, 85.127584015254371, 85.376079779729409,
  85.645528480550325, 85.869378126762442, 86.005804323500811, 86.039161381018758, 85.965823486413669, 85.844009137890751,
  85.809968101512069, 85.913945804410147, 86.376669108422320, 86.940105232321841, 87.610726569253586, 88.208709686765786,
  88.754140199427212, 89.244195656951192, 89.646655328114477, 89.947436060687807, 89.856996811960130, 89.329788342484221,
  88.423233901377387, 87.618301314755570, 86.934977825658592, 86.387170558270725, 86.076804569878860, 86.004847000926816,
  86.061923205140161, 86.215227255638638, 86.869245112868981, 87.601767910312589, 88.654629402326663, 89.761854258219302,
  90.728516993201794, 91.512896015057962, 92.090097957330343, 92.460984894475757, 92.630919291538731, 92.034976218353307,
  90.476266722138504, 89.138850634633584, 88.055963153502063, 89.031170359694300, 91.836079868808270, 96.005561263430863,
  100.198497642747554, 102.659074287924199, 103.943652638866112, 104.715129467146625, 105.458907767592976, 106.045493569502554,
  106.481379839305177, 106.777644662371230, 107.176762118579674, 107.728381058107189, 108.473435738529687, 109.745120015916783,
  113.713320495890173, 117.373355428977618, 119.559585401685737, 120.814359744677844, 121.550492637072495, 121.959234518443338,
  122.048654231987101, 121.103680387949836, 119.422427075142025, 118.125462675085501, 117.152733215990722, 116.446764809563817,
  115.870006362125395, 115.389863838818172, 114.967897505191814, 114.648257473064902, 114.779721337753855, 114.967181386450306,
  115.188643695020815, 115.390094046480073, 115.527264469751174, 115.611419697958397, 115.661683392238700, 115.844145551565873,
  116.113482473354679, 116.478927577451557, 117.837933299327915, 119.100212112719703, 120.177688019227290, 121.084231343664442,
  121.846497978664601, 122.472072392452475, 123.018827081316090, 124.458250413402439, 126.616670211551039, 128.948198295055107,
  130.629292259608775, 131.973104675136369, 133.149757262280389, 134.966007249629371, 136.623532501384830, 137.894400000037109,
  138.784602595336253, 139.403869836747134, 139.792891581147614, 139.960142494148954, 139.051280168841032, 137.920184385896306,
  134.535557454537269, 131.657673291727207, 128.970290370054244, 126.950514859938480, 125.522823852697186, 124.531954964095235,
  123.869699445878339, 123.398428827668411, 122.620317779886847, 121.583858890947624, 120.801289167948028, 120.270557936991977,
  119.938797756242963, 119.708201556584797, 119.596512672063639, 119.559244387892733, 119.614200587636404, 119.967573095179048,
  120.718294913088982, 121.430507595273951, 122.043364806187498, 122.509310496062568, 122.875655376592235, 123.122394788644129,
  123.261044510101911, 123.321766208818815, 123.350369717915555, 123.355386885789173, 123.372303341764749, 123.471059703793628,
  123.642444536924927, 123.931013880954879, 124.813453455314288, 125.710861081384678, 127.535091522003327, 129.495807488817263,
  131.068348303386074, 132.319142893251978, 133.273730688073670, 133.927969231665287, 133.819421006831732, 133.602299767483146,
  133.265760397219282, 132.662839045004858, 131.112480712454754, 129.777491627861821, 128.536374735131631, 127.450697788458839,
  126.091073261837934, 124.877992752131163, 123.294175400915606, 121.991123591401816, 120.975858485905633, 120.170765099101160,
  119.351740461075408, 118.010819401866414, 116.775214303653257, 114.710540247367788, 110.708148218582977, 107.925740920113867,
  106.099677507747884, 104.927653856313356, 104.169868337805866, 103.686125944186088, 100.325742742817141, 96.617556449407815,
  93.954067666244001, 92.408870539868943, 91.480583715846336, 90.937826109600181, 90.691985766502398, 90.689866142280849,
  90.836186535446430, 91.057993327673216, 91.264943659453564, 91.274163427747865, 91.278117490957754, 91.300506666447106,
  91.420668582788622, 91.619859296436289, 91.894598721809373, 92.192316407665942, 92.493540974328639, 92.767062828030589,
  93.086484618530463, 94.566586291134982, 98.376990029371228, 101.301781987945830, 103.441560120050610, 104.988469032822650,
  106.093016804732315, 106.819952185784686, 107.245084322653085, 107.474174474254852, 108.128461957770156, 110.591560218857808,
  113.098403292630550, 115.492799231613901, 117.180718230694069, 117.820015993749635, 117.953514565077796, 117.715091808853998,
  116.834282201658866, 115.899091336969491, 114.976510272614803, 114.092003362683940, 113.283598925027917, 112.526250051043718,
  111.825368768292662, 111.209513591267040, 110.690723429751515, 110.252466886781221, 109.877798117435631, 109.538074803462450,
];

const expectedLength2Phase1 = [
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  85.250000000000000, 86.520031749101960, 86.117514275385531, 88.183873476933726, 88.511839111458599, 87.398400492554103,
  86.919828659662286, 85.466388182327009, 84.478006059821041, 83.988361664106122, 83.524773751118616, 84.862430968534369,
  88.534954288248585, 89.350042051828680, 90.676143069530113, 90.817468515276417, 91.263837955176271, 89.724559652920377,
  90.506963215265401, 90.555252479237424, 89.497643166466418, 88.951260469143264, 84.950581310724687, 83.712374912349034,
  82.922500162986694, 84.132704721826826, 85.269298157779403, 85.986000845853980, 88.336424720214083, 89.126567921439118,
  88.835184985616223, 88.586889234167231, 91.212341773367768, 91.557839010522969, 92.758289712363265, 93.359782250828971,
  93.261854145269510, 92.186907342351915, 90.560996728223273, 89.847587103809190, 89.119713190342708, 85.779036467753642,
  83.726351935718256, 84.410323827775230, 85.515630992021073, 95.713475138390592, 99.547939826543384, 104.318620426052178,
  105.875088131581933, 103.292808634375248, 102.540500719350689, 103.918534413662812, 105.587004927499152, 105.982986367671458,
  106.070226150527873, 105.075430008243202, 107.870861140219731, 109.028669650378333, 110.133010729980569, 112.240103723749201,
  121.623304978475559, 120.406250064230520, 119.194378321921036, 119.159784558831561, 118.310498954473616, 116.951285547337434,
  115.632715165477066, 112.456305147327399, 110.908808706978789, 117.077330871914072, 116.601339648248128, 116.147798627076838,
  112.726420575726578, 113.264073665803551, 113.074539798576950, 115.216140335451584, 119.877530645992863, 117.472269401739538,
  117.020945686468153, 115.763823234614705, 114.665675894897390, 115.167519351646320, 115.686516922852803, 119.948318170583761,
  120.321103476042850, 120.646238699063275, 124.061832516713835, 123.754533284074299, 123.169486483743015, 122.710095063337832,
  122.963926823040268, 122.699685000527751, 124.015313584971139, 128.599301283413581, 130.676504216830921, 131.956444485387379,
  131.375099918450047, 132.337037379800393, 133.561125459717317, 136.771323209926095, 137.660984296403171, 137.877746485911842,
  137.462347607012049, 136.636502691574663, 136.312254360032000, 135.120018154373071, 129.115879039220005, 128.754152825060032,
  124.514559415328748, 124.521492638298611, 123.435534613494141, 125.473139206345493, 127.831602487819580, 126.153216924761793,
  125.731185934274322, 122.939056762851223, 119.874975970418461, 118.726196009003644, 122.350872168675224, 123.322947324999163,
  122.600222093149114, 120.039184094842497, 122.515075564990468, 121.672609065593235, 122.791538308722693, 126.700864318413565,
  128.217491202356996, 124.727276700148252, 123.274741380393365, 122.114444973403934, 123.654935583864017, 122.605586932415306,
  122.368677758672732, 122.749554015127174, 123.643179951485578, 123.389269191174975, 124.186654598981860, 126.530551753252055,
  126.214464915379352, 128.131606069565862, 131.392680189893440, 131.119394766477541, 134.042143830934720, 134.861514949582642,
  133.194930729525709, 133.165283761043042, 132.312626220477398, 130.639872744280154, 126.011237248091632, 129.235535724173417,
  127.864623564215833, 125.786975131434886, 122.590423826556787, 124.141132587040815, 123.445241101618066, 123.431950805214470,
  120.881703838485564, 120.812980148573700, 118.498918857750780, 119.311589766903197, 121.298523462934241, 119.959548877331798,
  117.073946557526469, 114.056936400704870, 114.026623612796953, 110.737417973794862, 105.727215023950038, 106.372904230487137,
  107.452963568288439, 107.205735090716956, 107.128754859137430, 107.034797162986976, 93.170698204077425, 93.322475979711527,
  93.695775801936733, 94.962009919186400, 93.681461830844540, 94.468441124672708, 97.456642364442985, 97.134410523946173,
  95.499614930819376, 94.606405386515775, 92.271788243039509, 90.699061889738275, 93.015283171054477, 93.568590172917084,
  96.242922520745196, 95.534231419852674, 95.721654524090880, 94.583132539790199, 94.531177210244252, 93.983936866118682,
  97.083223322023358, 103.119636765207318, 107.373662525329067, 106.669582903063670, 105.120256368347597, 104.936770070172130,
  104.405042818050703, 103.431869836866113, 103.355276308521056, 104.678234619076278, 110.963705386870870, 115.466984339357566,
  116.513403930149792, 117.890358733953761, 114.294400190534503, 109.614948993948204, 109.452120093846318, 109.296545712476885,
  107.658679254969542, 108.610495578898011, 109.638478959400956, 109.402527536609469, 109.886459764048809, 108.610315913967995,
  108.530260532237548, 109.371726275899547, 109.732267846178544, 109.248409537477443, 108.870314241928966, 108.149665298115494,
];

const expectedLength5Phase1 = [
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  85.250000000000000, 85.604269106134396, 85.846112706014466, 86.709160446285850, 87.523225878987603, 87.676560431877789,
  87.487355839948989, 86.750327551228750, 85.797756054201827, 84.936923813796980, 84.214036671717409, 84.253473983894466,
  85.978176780553923, 87.585136977765060, 89.245369316391916, 90.210737849055491, 90.866234427979421, 90.658698373403169,
  90.632882830910972, 90.621719957181796, 90.233152585947053, 89.712466600628971, 87.564762887636419, 85.527711724807205,
  83.986718637249410, 83.633554753757792, 84.049909715949369, 84.766121746495173, 86.339038378852223, 87.712614105070244,
  88.439776879811518, 88.707406570269583, 89.834994827195089, 90.688425176458708, 91.754632049454671, 92.612736776708530,
  93.082828619143740, 92.920360613741423, 92.107306587376414, 91.162782317246723, 90.224927066616402, 88.030877341930477,
  85.601300807087441, 84.608062721578463, 84.621405877489138, 91.805567362462355, 97.243984440563111, 102.550713017524515,
  105.242733334514867, 105.227080774805586, 104.444262704269136, 104.209843218493972, 104.813733835340940, 105.374917463603722,
  105.768676592196385, 105.636167560542930, 106.459707777980341, 107.602936257715299, 108.873643218322059, 110.649364635854909,
  118.332950458418495, 120.420660628802807, 120.518508602795919, 120.195435673664548, 119.539294810615417, 118.512568530039957,
  117.222557334602726, 114.816531249240583, 112.602407143195123, 114.133653560875615, 115.114111955237306, 115.641633337334866,
  114.640375748291049, 114.009914105978027, 113.523535468550023, 113.957367603309436, 116.677778827315024, 117.580436901355498,
  117.670900061691356, 117.067502409488171, 116.109312349356102, 115.577715400726689, 115.474650333170089, 117.209911002516691,
  118.605010312666451, 119.651315967154744, 121.898068404822951, 123.046614695622864, 123.413985475584155, 123.322125256291798,
  123.234583642141345, 123.053628776697707, 123.383297698547878, 125.731039650160909, 128.412976738856941, 130.567294716906929,
  131.406261731547090, 132.071013720532648, 132.901492101522507, 134.919371257193006, 136.516397355609371, 137.436044898977485,
  137.727677033325790, 137.478444658274668, 137.068658102253153, 136.310714769663292, 132.702064070864765, 130.482401606293280,
  126.988967344829760, 125.289651090115314, 124.006434613420510, 124.101936468115241, 125.383304539460127, 125.878024673227003,
  125.951465850448926, 124.855576870392042, 122.474369845683171, 120.410979191635320, 120.499177234943701, 121.359332679458902,
  121.917890188989887, 121.443239514692905, 121.652701235892806, 121.641708599516960, 122.051264936094412, 124.050267344437515,
  126.174706679666116, 126.253077637573710, 125.291561579760923, 123.923099100874623, 123.542456173574990, 123.075114356540567,
  122.704901885386320, 122.618087402563106, 122.938754141404317, 123.143043898885935, 123.563157632133539, 124.668775468487965,
  125.439770080729062, 126.627297901744569, 128.959759447266549, 130.240462823488684, 132.264314899687292, 133.778642582002732,
  133.975305346003125, 133.834751034691493, 133.317869616652217, 132.287439864635644, 129.290129120841414, 128.547523275649581,
  128.017314311995733, 127.015458911075584, 124.836673961787923, 124.097481577041108, 123.606091855595068, 123.374602181142976,
  122.295958112475063, 121.527462605853032, 120.079014205520878, 119.470482515936041, 119.902252462839115, 119.935111244763689,
  118.890730170716978, 116.603108388992865, 115.189338453740461, 112.807144935115744, 108.600519805295320, 106.913472316970257,
  106.613101904705829, 106.628674958358218, 106.729947348865537, 106.807292903552280, 97.623423303558369, 94.372776117295686,
  93.433624821341184, 93.647722034334663, 93.560699892051531, 93.822950040552939, 95.109587272667582, 96.041018997506967,
  96.063284229587737, 95.594396713568202, 94.272570051860953, 92.614225247711559, 92.318685913945515, 92.604121150618781,
  94.010211626140403, 94.803282078573986, 95.331901029111137, 95.207648254849332, 94.980725067557728, 94.588213041341589,
  95.289410061179368, 99.274019351906745, 104.230314578144103, 106.155339438546662, 106.348826790289905, 106.035317866482941,
  105.473147045528094, 104.673210764956764, 104.057248155554277, 104.144104373676726, 107.275743113238050, 112.034624409171983,
  115.005465042514743, 117.040548222924514, 116.680692623384502, 113.498728401013381, 111.411787513543203, 110.169356241032801,
  108.786159294163653, 108.372201314967910, 108.657690075390775, 108.923484745408331, 109.305144257899116, 109.123039143376872,
  108.885340215450981, 109.004112544111365, 109.271654573136473, 109.313830724749948, 109.173911064832424, 108.783051373196500,
];

const expectedLength10Phase1 = [
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  85.250000000000000, 85.524168197929896, 85.726657073948573, 86.096671737446115, 86.559558839986664, 86.923473746591384,
  87.145241348914936, 87.104433067602258, 86.810603079109526, 86.345266940648131, 85.778575558590418, 85.352662628749130,
  85.592578035173986, 86.209367383387885, 87.368076650645847, 88.386355273703259, 89.290876730262639, 89.838892836333059,
  90.220905673250130, 90.473455402093592, 90.522074238682222, 90.395170661579783, 89.273053857686804, 87.722256757774929,
  86.122905827930779, 85.078421471490998, 84.534013933467747, 84.388811393316303, 84.940379423796230, 85.783904487846314,
  86.554646800010858, 87.194189600988324, 88.302786212277780, 89.259588042449863, 90.384876571269629, 91.395132121253809,
  92.145884664262923, 92.577525203497117, 92.624431055880436, 92.369324011638938, 91.886900823825542, 90.213059990777012,
  87.806510363475113, 86.251421079835978, 85.362139021881319, 90.091091897882023, 95.336272774949151, 100.654523780221353,
  104.265086527535118, 105.283395559289801, 105.306098629968702, 105.052289931237738, 105.168486659769897, 105.396833006339691,
  105.623726803649333, 105.706838097132831, 106.169476864279076, 106.907223492942876, 107.886278528241206, 109.443461420777268,
  116.196763436621652, 119.238081594150728, 120.356341841255642, 120.656796540249346, 120.599834276744716, 120.213908629327818,
  119.460165398538081, 117.455200595378599, 115.142071150537788, 114.511017527076888, 114.348935578380690, 114.446860506726466,
  114.319754079736938, 114.148646004056573, 113.922009635164684, 113.895073457466808, 115.126288107686619, 115.989561388464622,
  116.552478691781587, 116.766550013008967, 116.652790346412914, 116.418205345564559, 116.194405069902672, 116.580607634966938,
  117.145921357695116, 117.830223932979862, 119.762627536319243, 121.192967681336683, 122.164761278086488, 122.760580427029453,
  123.121873322699869, 123.291476893028815, 123.477628723274023, 124.883115934297138, 127.029003163007943, 129.174153748612753,
  130.480949129526010, 131.454268666084545, 132.360190627712484, 134.136838858561958, 135.708949893869374, 136.816422751177868,
  137.485254481383436, 137.779388488557117, 137.807582844250192, 137.559372707513290, 135.290095061968657, 133.314764298169337,
  129.530522282174275, 127.097669628348839, 125.247757823973544, 124.290902368612009, 124.117449137451388, 124.241149139559099,
  124.468032574788879, 124.389484828299274, 123.335050071880701, 121.915869183283093, 121.147327289044185, 120.935181357375072,
  120.995073632039890, 120.958949855332804, 121.066354464259177, 121.163652811840905, 121.376413491202243, 122.354081389158267,
  123.845597231226961, 124.774384597440672, 125.139562688086571, 124.944716916030842, 124.689055911565717, 124.315187293675777,
  123.899025495110507, 123.541212669791648, 123.347181937117739, 123.242223692962341, 123.285787375726159, 123.635924604755161,
  124.105836703844844, 124.819252462645409, 126.576963482044633, 127.976758052542593, 130.157442230811625, 132.038523566697904,
  133.157884099226123, 133.775454217955087, 133.973211089215226, 133.749893616849477, 131.940484097069145, 130.721857767950297,
  129.787825859808493, 128.774436961404120, 126.863172540639056, 125.601292201548233, 124.690114688267855, 124.055385872001438,
  123.150628210949250, 122.411754547516594, 121.221383212547082, 120.377343066726070, 119.986465272830316, 119.750198291315400,
  119.245587054794811, 117.831556495355613, 116.625056228270694, 114.439172323968961, 110.070817798597716, 107.737037070648256,
  106.581755543762014, 106.067272915602231, 105.878553484959596, 105.866069611385655, 99.335426042230281, 95.717363567588805,
  94.035075319359038, 93.404303327733558, 93.133641867437504, 93.104550701742582, 93.486960841660462, 94.055721715499786,
  94.520047592600079, 94.784617856532719, 94.604416398585229, 93.927315008798089, 93.429250926319398, 93.143403620202989,
  93.319589748308616, 93.639569859966414, 94.045016465232507, 94.336062175974590, 94.524371388215940, 94.571115948660136,
  94.819329472368480, 97.298862058042673, 101.943205354388397, 104.558086274762388, 105.934933838326941, 106.548402704474626,
  106.657075068752690, 106.392703077734325, 105.946980744621598, 105.584050972577415, 106.850211472852834, 110.523774129221778,
  113.459380806857823, 115.801561514176370, 116.886863407918412, 115.764086138305316, 114.416947822824795, 113.127825741503457,
  111.540906109449537, 110.401048030332632, 109.704869286519013, 109.294173896040704, 109.132624613064095, 108.987984305386831,
  108.855769189138613, 108.823718180225740, 108.888037665602880, 108.954354804250357, 108.978090923271594, 108.898203085126539,
];

const expectedLength25Phase1 = [
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  85.250000000000000, 85.045544437533991, 84.922182558048036, 84.901263844295315, 84.957226672513158, 85.064730178698184,
  85.203972266764481, 85.343434768925988, 85.459017502591834, 85.536271985703081, 85.566020462349172, 85.565932910288353,
  85.588823220347720, 85.662275895547936, 85.916702667079875, 86.239516854544860, 86.648015602306131, 87.039443883306944,
  87.419941799276756, 87.786579287862224, 88.123429899214202, 88.420066982245658, 88.575401477490118, 88.508981003830669,
  88.189779778125938, 87.866950856828467, 87.554717168262897, 87.266754280305122, 87.040565158593822, 86.902304944188714,
  86.828216687509297, 86.810376660319974, 87.068401501556920, 87.411117265994903, 88.008670121219865, 88.708906310256538,
  89.367084524460836, 89.940312648992617, 90.417292672027727, 90.794269042595204, 91.068307966758297, 90.987576662533570,
  90.304694533319847, 89.643093353644545, 89.058604503993010, 89.481693352422425, 91.200464373601832, 94.121273596365270,
  97.452144583372856, 99.958084037872723, 101.541389639693875, 102.723084554498001, 103.799633992433954, 104.628924296717841,
  105.247361341097147, 105.702934959811373, 106.189081029462130, 106.748261248385646, 107.429268076380737, 108.523994448508418,
  111.359127369225817, 114.360719516565013, 116.559150255777396, 118.072326658298365, 119.088782572644348, 119.822313837944819,
  120.305066062767338, 120.124556425813964, 119.363199979930002, 118.671437197258953, 118.092615578227907, 117.614991003447258,
  117.185082007214021, 116.798229760941339, 116.439545786924839, 116.127458215428462, 115.992966917073176, 115.916972045727405,
  115.889060307410446, 115.884149149111778, 115.878351564282099, 115.869131852625387, 115.858721712681572, 115.919522177954946,
  116.030434867371653, 116.200964186534421, 117.018110227021396, 117.831619186747005, 118.568003964970856, 119.225797362051608,
  119.816343884999725, 120.342467992289258, 120.839128966586188, 122.135700996432107, 124.096751460670404, 126.284867490752220,
  127.954501210783562, 129.364957381996248, 130.633190509270719, 132.472159392319185, 134.169779660248508, 135.522481074521636,
  136.530946596873179, 137.298822359051599, 137.873195788796096, 138.272080217422427, 138.080755731251998, 137.679561143982653,
  135.657405223918175, 133.728142605096338, 131.696950944420109, 130.056748793096403, 128.763182426724825, 127.744039799838248,
  126.945496966286697, 126.275094221674365, 125.361555028446773, 124.273179723054454, 123.388494940400861, 122.691881443376701,
  122.151778188492202, 121.718843940041779, 121.388691341267474, 121.137003187846403, 120.965114122095471, 120.949045274333244,
  121.160733531718563, 121.412870237467502, 121.672530662666887, 121.909076479920728, 122.129755511893038, 122.317347168865481,
  122.467513448225276, 122.585326489667693, 122.684986452053153, 122.768242585851112, 122.848927511822993, 122.957623047521508,
  123.095653281824909, 123.285967100027747, 123.801039396067608, 124.346244153480868, 125.555940614280431, 126.964130652384398,
  128.164866070612817, 129.190764731886020, 130.055697141732821, 130.758290445177465, 131.143149112957389, 131.403930045166362,
  131.542819031463097, 131.493245744151778, 130.848608800534436, 130.235232140386557, 129.579597076368771, 128.953697770810265,
  128.034246510408053, 127.150118755742838, 125.899232608596449, 124.812634839580014, 123.893358268823761, 123.105010234466434,
  122.265958301013740, 120.983927100132675, 119.778683850644242, 117.858126674098116, 114.492561907349895, 111.835576098449877,
  109.905249593167341, 108.496080623083131, 107.457170484431245, 106.683736596121264, 103.913159245080450, 100.581756697881019,
  97.659280827363375, 95.727158631764468, 94.347497531948648, 93.402953290041921, 92.735428140206650, 92.300739401945037,
  92.067476094977366, 91.965969941086897, 91.958257197981553, 91.898658623896821, 91.853092714745287, 91.827207623315033,
  91.852286745515954, 91.923564619531845, 92.041606542459803, 92.186182623824337, 92.347942659418692, 92.511752378777700,
  92.705099630606853, 93.552975341099668, 96.123386331002934, 98.307624273653985, 100.039229871400551, 101.415066133841407,
  102.514096735083541, 103.372779085126069, 104.029262290587553, 104.533533178401726, 105.408187780110936, 107.693640169689814,
  110.106494839909601, 112.485654698096710, 114.308352740267736, 115.452784126567082, 116.199351017742686, 116.622406412133614,
  116.551951830568782, 116.322428186403513, 115.983445596104573, 115.567096887344420, 115.108551915111846, 114.615417127888577,
  114.103698923072784, 113.597125207504789, 113.112167312024667, 112.652165710142469, 112.217725644385595, 111.802295255300834,
];

const expectedLength50Phase1 = [
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  85.250000000000000, 84.994149470870482, 84.786438078206615, 84.629842710255204, 84.513775335708914, 84.433274823269315,
  84.383726504128930, 84.359199157865348, 84.357965477856794, 84.371321710748077, 84.392519894705600, 84.416897609302140,
  84.448997714298272, 84.492244514489471, 84.579236180821638, 84.689935572208725, 84.837687613134250, 84.995157203239955,
  85.163125224513792, 85.340985837720538, 85.525791876434411, 85.714677787860566, 85.909849677110145, 86.095408956101153,
  86.247778197980423, 86.377666865447111, 86.486647370417685, 86.577063942611829, 86.654570677806177, 86.724510291311248,
  86.789875962753300, 86.852640799454150, 86.959197948340488, 87.086584378576447, 87.307614262392462, 87.598158773215289,
  87.904582515430931, 88.196173631183740, 88.471273031107415, 88.728373835170615, 88.965451722626966, 89.167192128680085,
  89.257090366264961, 89.302361731119433, 89.326081929546291, 89.509299635627372, 90.104760298162731, 91.270466289184625,
  92.921439776462577, 94.721750988386631, 96.462257506811071, 98.114550626429732, 99.691715585291206, 101.154949779291357,
  102.389444828188715, 103.382968906978405, 104.356870585424559, 105.296164169169543, 106.237309819637346, 107.286393371512503,
  108.785226782552016, 110.549711937187297, 112.359562420211574, 114.087164314817556, 115.488678304556927, 116.623200364471458,
  117.598681796254652, 118.302135949205578, 118.712570189445103, 118.970420257945761, 119.173807104230761, 119.329614807059542,
  119.428664617080713, 119.486219788519236, 119.505047759858314, 119.492379872680900, 119.404685120109662, 119.313568459965978,
  119.220968743939167, 119.126004649160052, 119.026871447380088, 118.924068395123896, 118.818649543100022, 118.713153433371716,
  118.620572647939312, 118.548207191211063, 118.659406886705668, 118.819983618023585, 118.998383607202200, 119.179886054587442,
  119.368375890964941, 119.555052552163943, 119.771492351763541, 120.519554101729128, 121.759368686102079, 123.325673661515495,
  124.713578141401143, 126.073623570040382, 127.425205514157241, 129.008948708413840, 130.705571463082691, 132.258784466656635,
  133.555052956411345, 134.635848201462409, 135.545677942693032, 136.333570051270101, 136.926678620654059, 137.394287729664256,
  137.278216977849354, 136.960760954684986, 136.331345416459527, 135.738095585519090, 135.180565537563268, 134.650267006096101,
  134.146865474056028, 133.566015300003215, 132.643432211114060, 131.487269730449498, 130.441283160501598, 129.496501576982212,
  128.642792518641016, 127.849473779034525, 127.130914044094624, 126.479046361326411, 125.889935727162282, 125.365112688932967,
  124.915043648052915, 124.523089229420677, 124.181981967140388, 123.883747988769670, 123.625395074557247, 123.400582137547303,
  123.204511665426054, 123.033893853596865, 122.887278539255348, 122.762010785099235, 122.657593305534562, 122.576907474456860,
  122.519615489078191, 122.488996200169339, 122.551412026770379, 122.645230446177109, 123.006713943284083, 123.540982901062094,
  124.052507622611458, 124.553168215955836, 125.034511803242609, 125.494520724405490, 125.936390504658533, 126.347880701384597,
  126.726513585788069, 127.067343958518137, 127.333205614468355, 127.558238727153551, 127.726019391712356, 127.854216449913082,
  127.841564916313814, 127.768788903978731, 127.465196184961783, 127.143258974926923, 126.827154972919359, 126.499397478110822,
  126.047575075553112, 125.236079795874858, 124.371259356921684, 122.908830731621265, 120.740121153908959, 118.482000807150555,
  116.515460612337478, 114.796242244604741, 113.319386397293627, 112.051070999035616, 110.037960372614890, 107.548257631365971,
  104.869967318146138, 102.453018285113558, 100.122148204433287, 98.240769198311995, 96.626829332221305, 95.297240297326510,
  94.257360896622714, 93.441338830203080, 92.816346414119451, 92.291058867846829, 91.837363413721505, 91.447335353290171,
  91.118240594747661, 90.845452354314006, 90.625596060851095, 90.452569836759722, 90.321641335266790, 90.227202488232706,
  90.170139346727424, 90.282841170360726, 91.030569654572290, 91.855760941313278, 92.638042576379405, 93.386237969329358,
  94.087980466904440, 94.746578828214552, 95.365439628743459, 95.950028945980080, 97.001222313830056, 98.970098636777124,
  101.446811288729123, 104.194506156907963, 106.523951984351541, 108.549610235177482, 110.299681395255249, 111.799878119440081,
  113.038526468170090, 114.076660639359915, 114.936368734851925, 115.636679010301165, 116.196383570675152, 116.629563456841822,
  116.950357489303698, 117.173377742279285, 117.311816503589569, 117.376359909609022, 117.376412957423241, 117.319390294538294,
];

const expectedLength75Phase1 = [
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  85.250000000000000, 84.961041791749096, 84.722567203075627, 84.519155784932764, 84.344318816597308, 84.195832172015258,
  84.071569127904112, 83.980062652693121, 83.920877467904859, 83.886209056298824, 83.870960327936416, 83.862460640913255,
  83.861674061464569, 83.869392162609557, 83.898504873860631, 83.940442147723303, 84.002551184347013, 84.073124369397576,
  84.152448350293085, 84.240388881369029, 84.336041028784024, 84.438437554256410, 84.550083915463603, 84.671090885988392,
  84.797704350191452, 84.918185139011541, 85.032322557515627, 85.140225708393686, 85.243240424466009, 85.342635935424553,
  85.439164435504040, 85.533383205782258, 85.651838030345772, 85.779735489584695, 85.962101420936690, 86.188779435028437,
  86.428522369359541, 86.660223923658364, 86.883712108716310, 87.098736962949303, 87.304769046726136, 87.506568941083131,
  87.694298211226396, 87.859448423673953, 88.008236082919396, 88.272344245297361, 88.748506891768272, 89.525920861153764,
  90.606212283712566, 91.871553165148200, 93.222622317752240, 94.619493570247016, 96.042448838536643, 97.455436022733011,
  98.823655733540591, 100.004874367262602, 101.164890419764163, 102.309132160143065, 103.444239653643891, 104.594278173245002,
  105.920782457449761, 107.392353357901072, 108.936625123698363, 110.495501450083822, 111.995113249210760, 113.280029446247426,
  114.394465720187256, 115.340726424454346, 116.107990823713678, 116.716584468422880, 117.248390373050725, 117.716141343278352,
  118.127738264648784, 118.491535965891245, 118.810204229012044, 119.087729037908559, 119.257036191594139, 119.403688003442568,
  119.529753131370413, 119.636351437913319, 119.724183036787153, 119.794544830995889, 119.848845333711353, 119.866630236256512,
  119.871052494705737, 119.868088995754320, 119.921485775078892, 119.997586989572312, 120.084837507919858, 120.176486937459174,
  120.274846978358980, 120.373612571664395, 120.492322493038799, 120.879362379331312, 121.527209961009191, 122.404749409044854,
  123.306244963235784, 124.334948688965824, 125.471963936592957, 126.731452668379859, 128.081417209483902, 129.474563161531108,
  130.733823837651357, 131.834987534800860, 132.801521893771167, 133.681055159209819, 134.453724176242872, 135.149217777287333,
  135.603273290961823, 135.916042162689791, 136.027843374074365, 136.107935824260522, 136.159322226267108, 136.178133705297427,
  136.170994539182175, 136.056768244524818, 135.660521804495602, 135.030669776083158, 134.431843592017344, 133.862114592016525,
  133.319148913638685, 132.761558340725401, 132.229980382897708, 131.722267213261375, 131.237528804318714, 130.776670892053943,
  130.340768984472930, 129.928472793819424, 129.538106665278491, 129.167631687840554, 128.816446192742802, 128.482853298206976,
  128.165524152939440, 127.863528997237125, 127.576485065316504, 127.303628500259549, 127.044853107857293, 126.801164415010334,
  126.572655499945370, 126.360599664595568, 126.174496444562152, 126.007975281044452, 125.914708044815029, 125.894666138766524,
  125.889683308361398, 125.905695125331789, 125.936063814949065, 125.979308724545646, 126.033603704683628, 126.096297912194885,
  126.165274896861135, 126.237857328620308, 126.319772373396148, 126.398176522070102, 126.470687461687021, 126.536369055396349,
  126.576051961014826, 126.598489139415960, 126.546397291818408, 126.477903825530262, 126.403312460092863, 126.312541613839642,
  126.150575798318229, 125.785536321385521, 125.354294404109069, 124.516515076226881, 123.239439166469907, 121.699607413083456,
  120.231990743484630, 118.836604081580489, 117.553764731802573, 116.384477416823799, 114.777320581303883, 112.824361923964560,
  110.645453820424876, 108.387062379293752, 106.118438537166767, 104.092571400188049, 102.308508728894296, 100.761997689242207,
  99.433436743939069, 98.287007934193397, 97.258846784673693, 96.299517793574267, 95.442920945063463, 94.677740642925798,
  93.981884090046606, 93.350908156432425, 92.780977173839119, 92.267595543504896, 91.806817516786495, 91.394546489348699,
  91.028858563019554, 90.749810373752155, 90.724545668645035, 90.789572105569093, 90.884424582034853, 91.010976542947546,
  91.154095197715208, 91.312807191792629, 91.486232816911169, 91.674230887986255, 92.223558611994534, 93.457179682015052,
  95.195370464589573, 97.288125712757818, 99.162199023610370, 100.878732865439687, 102.448437272742808, 103.881195433573126,
  105.185341768431812, 106.369846287041582, 107.443507544940317, 108.414195969749699, 109.289718510895014, 110.076418895773116,
  110.780609050538146, 111.408744622825566, 111.966866275443735, 112.460238316516183, 112.893694951198583, 113.271400457559722,
];

const expectedLength100Phase1 = [
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN, Number.NaN,
  85.250000000000000, 84.998610866256357, 84.788699273928842, 84.601168986686389, 84.432368698057999, 84.281224300378838,
  84.146693798268032, 84.041793323244619, 83.966428216646932, 83.914341043998164, 83.881669826599122, 83.854651615634197,
  83.833604233520830, 83.818805093918115, 83.817983464652499, 83.826083666886021, 83.847791050915617, 83.875662508358943,
  83.909853764384849, 83.950346106862284, 83.996782800476169, 84.048763651790168, 84.107005765787946, 84.173679088157058,
  84.249766688455239, 84.325221039935826, 84.399734179043762, 84.473142740825580, 84.545837825877797, 84.618213575462121,
  84.690470617841228, 84.762745483703725, 84.852667204268911, 84.949967423768797, 85.085936492999465, 85.255249507048930,
  85.436697898000190, 85.614167598431564, 85.787642769129491, 85.957052848222403, 86.122183787067897, 86.288867752909042,
  86.464415787541327, 86.629483256491085, 86.784955968229667, 87.046038213128213, 87.454224522891479, 88.058255917503899,
  88.868998847566459, 89.834488381950592, 90.903728272591081, 92.050602293423509, 93.258177127735948, 94.500896603172777,
  95.752564756273031, 96.918769685312199, 98.085525592495571, 99.250510043364898, 100.413718713000449, 101.585752778170772,
  102.852276125866425, 104.208884090113770, 105.625651198420002, 107.073841872823721, 108.511920817539675, 109.869456148761046,
  111.071608402809943, 112.145553120509987, 113.084563107421033, 113.908059020467164, 114.639676282680895, 115.293389054840986,
  115.896391517741407, 116.453264190067785, 116.966176788250820, 117.427508872671595, 117.794703194644924, 118.129881440655154,
  118.434589368803046, 118.714219717427241, 118.969823570438052, 119.202670213564886, 119.414049947664424, 119.574918176791400,
  119.707984078462616, 119.819243215030298, 119.955116608422017, 120.094697141588682, 120.232806630925737, 120.366846645050757,
  120.499046764672244, 120.626693730430702, 120.762112809770187, 121.041402526845530, 121.476333372567893, 122.064780229656748,
  122.733844812042861, 123.517969441082926, 124.397780487932934, 125.376078491652905, 126.440219715191532, 127.566841727289244,
  128.673728124712198, 129.681404045147360, 130.594086669845552, 131.433875289583824, 132.209230095031131, 132.929285217941924,
  133.526622879872775, 134.035149461796522, 134.424869459400554, 134.777800209602105, 135.095802624298443, 135.378073736367298,
  135.628113141008782, 135.794984011480949, 135.774505486003306, 135.578972679648842, 135.381269753452301, 135.181415847553581,
  134.979217013152720, 134.735167746183635, 134.491262477006643, 134.247086201817098, 134.002992135851940, 133.759980077323974,
  133.519149421600559, 133.280558624926982, 133.044094152445240, 132.809445935600024, 132.576890886058891, 132.346209926787537,
  132.117307006613629, 131.890230564795900, 131.665246925989663, 131.442443514306945, 131.222176844048960, 131.005286064023892,
  130.792226034462487, 130.583966776255039, 130.378526006999294, 130.180744307706647, 129.985954295587874, 129.807274957946845,
  129.640924606508634, 129.488766956177273, 129.349110643347160, 129.221441231131649, 129.104345857476090, 128.997475057364994,
  128.899881760714749, 128.810324128100859, 128.728852655994217, 128.652366428693597, 128.579736469337860, 128.510007257453566,
  128.434344181306187, 128.356805501197698, 128.245692079885970, 128.130729542780330, 128.016135304861109, 127.896209130472243,
  127.737220443798094, 127.450385537051545, 127.116201840734107, 126.491313629692186, 125.566179409394721, 124.400078526472967,
  123.228151661995994, 122.059424551386158, 120.942988042894925, 119.891025822707675, 118.540183226789267, 116.930578736503819,
  115.121135704750600, 113.191435732734377, 111.188576899967757, 109.247429880909849, 107.499121321783448, 105.929624728627758,
  104.507296230505119, 103.218415786405743, 101.980086703580625, 100.765621307049514, 99.661405904410557, 98.656250659577324,
  97.718912693475630, 96.847852183016414, 96.037561845389050, 95.290265120017494, 94.596600555337687, 93.955513581532031,
  93.362582063940266, 92.834673645972345, 92.446277706647550, 92.132024289761461, 91.857139605583882, 91.622856711411885,
  91.419894194442861, 91.246876290822698, 91.102499088672431, 90.985814453082966, 91.112891794367016, 91.718453736939978,
  92.724117151469471, 94.056596660520682, 95.296966487084532, 96.463272489834182, 97.559505221237345, 98.589362276618417,
  99.555923115841154, 100.462585953341119, 101.312736039300532, 102.109417363290575, 102.855700340592463, 103.554072000832207,
  104.207040434154692, 104.817217913874686, 105.387084221104303, 105.918823996417942, 106.414467184275935, 106.875779107505053,
];

describe('JurikMovingAverage', () => {

  it('should return expected mnemonic', () => {
    const jma = new JurikMovingAverage({length: 7, phase: -1});
    expect(jma.getMnemonic()).toBe('jma(7, -1)');
  });

  it('should throw if length is less than 1', () => {
    expect(() => { new JurikMovingAverage({length: 0, phase: 0}); }).toThrow();
  });

  it('should throw if phase is less than -100', () => {
    expect(() => { new JurikMovingAverage({length: 10, phase: -100.01}); }).toThrow();
  });

  it('should throw if phase is greater than 100', () => {
    expect(() => { new JurikMovingAverage({length: 10, phase: 100.01}); }).toThrow();
  });

  const verify = (length: number, phase: number, expected: Array<number>, outputName: string) => {
    const lenPrimed = 30;
    const epsilon = 1e-13;
    const jma = new JurikMovingAverage({length: length, phase: phase});

    for (let i = 0; i < lenPrimed; i++) {
      expect(jma.update(input[i])).toBeNaN();
      expect(jma.isPrimed()).toBe(false);
    }

    for (let i = lenPrimed; i < input.length; i++) {
      expect(jma.update(input[i])).withContext(`i = ${i}: ${outputName}`).toBeCloseTo(expected[i], epsilon);
      expect(jma.isPrimed()).toBe(true);
    }

    expect(jma.update(Number.NaN)).toBeNaN();
  }

  it('should calculate expected output and prime state is output data generated using original Jurik DLL', () => {
    verify(20, -100, expectedLength20PhaseMin100, 'jma(20,-100)');
    //verify(20, -30, expectedLength20PhaseMin30, 'jma(20,-30)');
    //verify(20, 0, expectedLength20Phase0, 'jma(20,0)');
    //verify(20, 30, expectedLength20Phase30, 'jma(20,30)');
    //verify(20, 100, expectedLength20Phase100, 'jma(20,100)');
    //verify(2, 1, expectedLength2Phase1, 'jma(2,1)');
    //verify(5, 1, expectedLength5Phase1, 'jma(5,1)');
    //verify(10, 1, expectedLength10Phase1, 'jma(10,1)');
    //verify(25, 1, expectedLength25Phase1, 'jma(25,1)');
    //verify(50, 1, expectedLength50Phase1, 'jma(50,1)');
    //verify(75, 1, expectedLength75Phase1, 'jma(75,1)');
    //verify(100, 1, expectedLength100Phase1, 'jma(100,1)');
  });
});
